library("jsonlite")
library("magrittr")

foo <- '{"date":["2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01"],"data":[4.2616,6.1817,4.4553,5.1886,4.949,6.287,5.5143,3.2664,5.0286,4.0618,5.4909,4.4139,4.4355,4.8373,4.7604,7.4887,4.689,4.9016,5.5865,4.8906,5.9461,3.1148,5.6692,5.1847,6.2473,4.216,5.7912,5.3531,4.5611,5.5251,4.6555,6.0889,5.0679,5.0039,5.5126,4.9429,5.8398,7.055,5.3866,4.8968,4.4086,5.253,3.4959,6.8534,2.8041,4.0245,6.7963,4.597,4.1744,3.8897,6.1501,6.3148,4.527,5.9529,6.5957,4.3128,4.9112,5.5343,5.6605,5.259,6.0253,6.4087,6.4844,5.3409,3.5648,5.2666,3.8509,4.9837,5.6191,6.1152,4.3244,3.784,4.1617,4.2416,3.5012,4.3738,4.9972,3.2411,4.5162,4.8602,4.9538,5.2651,5.5083,4.6463,4.3939,5.5441,5.361,5.1832,5.3341,6.6917,5.1665,4.74,3.5457,3.9677,4.8901,5.3906,6.4576,4.0105,6.33,2.1023]}' 
foo <- fromJSON(foo)
foo <- as.data.frame(foo)
foo$date <- as.Date(foo$date)

out <- list(
  dimensions = list(type = "int", semantic_type = ""),
  ts = foo,
  metadata = list(aggregation_type = "year", 
                  title = "What will be the daily closing price of gold on 27 December 2017 in USD?",
                  startingAt = "2017-12-20T00:00:00+00:00", 
                  hfcId = 241, 
                  endingAt = "2017-12-27T00:00:00+00:00", 
                  options = data.frame(name = c("Less than $1,200", "Between $1,200 and $1,230, inclusive", "More than $1,230 but less than  $1,255", "Between $1,255 and $1,285, inclusive", "More than $1,285")),
                  createdAt = "2017-12-20T00:00:00+00:00"
  )
)

toJSON(out, "rows") %>% writeLines(., file("basil-ts/test/example2.json"))

ex1 <- fromJSON("basil-ts/test/example1.json")
ex2 <- fromJSON("basil-ts/test/example2.json")
